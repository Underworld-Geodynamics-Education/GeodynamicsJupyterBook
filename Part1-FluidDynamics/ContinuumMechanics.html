

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Conservation Laws &#8212; Geodynamics with Underworld</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/spanels-index--0afa1ebdab0bb23b98b56d34c23d9f57.css" />
    <link rel="stylesheet" type="text/css" href="../_static/spanels-variables--ffc7f74dcb1b9eecba2dbcbc22818714.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Navier-Stokes Equation" href="NavierStokes.html" />
    <link rel="prev" title="Introduction" href="../Part0-Introduction/Introduction.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/MundusSubterraneus.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Geodynamics with Underworld</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../FrontPage.html">
   Geodynamics with Underworld
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction and Background
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Part0-Introduction/Introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Mathematical Fluid Dynamics
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Conservation Laws
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NavierStokes.html">
   Navier-Stokes Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MantleDynamics.html">
   Non-dimensional equations &amp; dimensionless numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ThermalConvection.html">
   Thermal Convection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="LithosphericDynamics.html">
   Dynamics of the Lithosphere
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Numerical Modeling
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3-NumericalMethods/NumericalMethods1.html">
   Numerical Modeling in Solid Earth Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3-NumericalMethods/NumericalMethods2.html">
   Survey of numerical methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3-NumericalMethods/NumericalMethods3.html">
   Introduction to the Finite Element Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3-NumericalMethods/NumericalMethods4.html">
   Practical Finite Elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part3-NumericalMethods/NumericalMethods5.html">
   Methods for Solving Numerical Problems
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Python for Geoscientists
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Part2-Python/0-StartHere.html">
   Python for Earth Scientists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part2-Python/NumpyAndScipy/0-NumpyAndScipy.html">
   Numpy and Scipy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part2-Python/Plotting/1-IntroductionToMatplotlib.html">
   Introduction to matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part2-Python/Mapping/00-Maps_with_Cartopy.html">
   Maps with the Cartopy Package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Part2-Python/SphericalMeshing/0-Stripy.html">
   Triangulations
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Part1-FluidDynamics/ContinuumMechanics.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Underworld-Geodynamics-Education/GeodynamicsJupyterBook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservation-of-mass">
   Conservation of mass
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservation-of-heat-energy">
   Conservation of (heat) energy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservation-of-momentum">
   Conservation of momentum
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="math notranslate nohighlight">
\[\newcommand{\dGamma}{\mathbf{d}\boldsymbol{\Gamma}}
\DeclareMathOperator{\erfc}{erfc}
\newcommand{\Red     }[1]{\textcolor[rgb]{0.7,0.0,0.0}{#1}} 
\newcommand{\Green   }[1]{\textcolor[rgb]{0.0,0.7,0.0}{ #1}} 
\newcommand{\Blue    }[1]{\textcolor[rgb]{0.0,0.0,0.7}{ #1}} 
\newcommand{\Emerald }[1]{\textcolor[rgb]{0.0,0.7,0.3}{ #1}} \]</div>
<div class="section" id="conservation-laws">
<h1>Conservation Laws<a class="headerlink" href="#conservation-laws" title="Permalink to this headline">¶</a></h1>
<p>We start by deriving the equations of motion, energy balance and so on
through a conservation principle. This will give a useful insight into
the different forms of the equations which we will later encounter.</p>
<div class="figure align-default" id="arbitrary-volume-elt">
<a class="reference internal image-reference" href="../_images/vol_elt.jpg"><img alt="../_images/vol_elt.jpg" src="../_images/vol_elt.jpg" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">An arbitrary volume, <span class="math notranslate nohighlight">\(\Omega\)</span> of material has a surface <span class="math notranslate nohighlight">\(\Gamma\)</span></span><a class="headerlink" href="#arbitrary-volume-elt" title="Permalink to this image">¶</a></p>
</div>
<p>A general conservation law does not distinguish the quantity which is
being conserved – it is a mathematical identity. Consider a quantity
<span class="math notranslate nohighlight">\(\phi\)</span> / unit mass which is carried around by a fluid. We can draw an
arbitrary volume, <span class="math notranslate nohighlight">\(\Omega\)</span> to contain some amount of this fluid at a
given time. We label the surface of the volume <span class="math notranslate nohighlight">\(\Omega\)</span> as <span class="math notranslate nohighlight">\(\Gamma\)</span>, and
define an outward vector <span class="math notranslate nohighlight">\(\mathbf{d}\boldsymbol{\Gamma}\)</span>
which is normal to the surface and represents an infinitesimally small
element on the
surface. <span class="math notranslate nohighlight">\(\dGamma\)</span> has a magnitude equal to the area of this element.</p>
<p>In general, we also need to define a source/sink term, <span class="math notranslate nohighlight">\(H\)</span> / unit mass which
generates/consumes the quantity <span class="math notranslate nohighlight">\(\phi\)</span>, and a flux term, <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>
which is the “leakage” occurs across the surface when the fluid is stationary (e.g. this
might represent diffusion of <span class="math notranslate nohighlight">\(\phi\)</span>). The rate of change of <span class="math notranslate nohighlight">\(\phi\)</span> is
given by combining the contribution due to the source term, the
stationary flux term, and the effect of motion of the fluid.</p>
<div class="math notranslate nohighlight" id="equation-eq-cons1">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-cons1" title="Permalink to this equation">¶</a></span>\[    \frac{d}{dt} \int_{\Omega} \rho \phi d\Omega =
            - \int_{\Gamma} \mathbf{F} \cdot \mathbf{d}\boldsymbol{\Gamma}
            + \int_{\Omega} \rho H d\Omega
            - \int _{\Gamma} \rho \phi \mathbf{v} \cdot \mathbf{d}\boldsymbol{\Gamma}\]</div>
<p>where the final term is the change due to the fluid carrying <span class="math notranslate nohighlight">\(\phi\)</span>
through the volume. Fluxes are positive outward (by our definition of
<span class="math notranslate nohighlight">\(\mathbf{d}\boldsymbol{\Gamma}\)</span>), so a positive flux reduces <span class="math notranslate nohighlight">\(\phi\)</span>
within <span class="math notranslate nohighlight">\(d\Omega\)</span> and negative signs are needed for these terms.</p>
<p>We can use Gauss’ theorem to write surface integrals as volume integrals:</p>
<div class="math notranslate nohighlight">
\[\int_{\Gamma} \phi \mathbf{u} \cdot \mathbf{d}\boldsymbol{\Gamma}= \int_{\Omega}  \nabla \cdot (\phi \mathbf{u}) d\Omega\]</div>
<p>One more thing: the test surface, <span class="math notranslate nohighlight">\(\Gamma\)</span>, and volume, <span class="math notranslate nohighlight">\(\Omega\)</span> are assumed to be
<em>fixed in the lab reference frame</em> which means that the order of integration and
differentiation can be interchanged</p>
<div class="math notranslate nohighlight">
\[\frac{d}{dt} \int_\Omega \rho \phi d\Omega =
                \int_\Omega \frac{\partial \rho \phi}{\partial t} d\Omega\]</div>
<p>That means we can write
$<span class="math notranslate nohighlight">\(
\int_{\Gamma} \mathbf{F} \cdot \mathbf{d}\boldsymbol{\Gamma}+ 
        \int _{\Gamma} \rho \phi \mathbf{v} \cdot \mathbf{d}\boldsymbol{\Gamma}=
        \int_{\Omega} \nabla \cdot (\mathbf{F} + 
        \rho \phi \mathbf{v}) d\Omega
\)</span>$</p>
<p>and then rewrite the general conservation equation
<a class="reference internal" href="#equation-eq-cons1">(1)</a> as</p>
<div class="math notranslate nohighlight">
\[
\int_{\Omega} \left[ \frac{d \rho \phi}{dt} + 
            \nabla \cdot (\mathbf{F} + \rho \phi \mathbf{v}) 
            -\rho H \right] d\Omega =0
\]</div>
<p>Now this conservation law has to work
no matter what shape we draw for the volume <span class="math notranslate nohighlight">\(\Omega\)</span> and so
the integral can only be zero for arbitrary <span class="math notranslate nohighlight">\(\Omega\)</span> if the
enclosed term is zero everywhere, i.e.</p>
<div class="math notranslate nohighlight" id="equation-eq-cons2">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-cons2" title="Permalink to this equation">¶</a></span>\[    \frac{d \rho \phi}{dt} + 
            \nabla \cdot (\mathbf{F} + \rho \phi \mathbf{v}) 
            -\rho H =0\]</div>
<p>This is the general conservation rule for any property <span class="math notranslate nohighlight">\(\phi\)</span> of a
moving fluid. We now consider several quantities and develop specific
conservation laws.</p>
<div class="section" id="conservation-of-mass">
<h2>Conservation of mass<a class="headerlink" href="#conservation-of-mass" title="Permalink to this headline">¶</a></h2>
<p>In this case <span class="math notranslate nohighlight">\(\phi=1\)</span> because</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \rho d\Omega \rightarrow \mbox{mass}\]</div>
<p>Of course, we also know that we cant diffuse or create mass which means <span class="math notranslate nohighlight">\(\mathbf{F} = H = 0\)</span> and
equation <a class="reference internal" href="#equation-eq-cons2">(2)</a> simplifies to give</p>
<div class="math notranslate nohighlight" id="equation-eq-maxxcons">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-maxxcons" title="Permalink to this equation">¶</a></span>\[    \Red{\frac{\partial \rho}{\partial t} + 
                \nabla \cdot \rho \mathbf{v} = 0}\]</div>
</div>
<div class="section" id="conservation-of-heat-energy">
<h2>Conservation of (heat) energy<a class="headerlink" href="#conservation-of-heat-energy" title="Permalink to this headline">¶</a></h2>
<p>The thermal energy / unit mass is <span class="math notranslate nohighlight">\(C_p T\)</span> and the conductive heat flux
<span class="math notranslate nohighlight">\(\mathbf{F}\)</span> is given by <span class="math notranslate nohighlight">\(\mathbf{F} = -k \nabla T\)</span>, (<span class="math notranslate nohighlight">\(k\)</span> is the
thermal conductivity).</p>
<p>Then the general conservation equation <a class="reference internal" href="#equation-eq-cons2">(2)</a> reduces to this</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\rho C_p T)}{\partial t} +
             \nabla \cdot \left(-k \nabla T + 
             \rho C_p T \mathbf{v}\right) - \rho H = 0\]</div>
<p>and if we rearrange these terms in the right way we find</p>
<div class="math notranslate nohighlight">
\[\frac{C_p T}{\rho} \left[ \frac{\partial \rho}{\partial t} + 
            \nabla \cdot \rho \mathbf{v} \right] + 
            \frac{\partial C_p T}{\partial t} + 
            \mathbf{v} \cdot \nabla C_p T = 
            \frac{1}{\rho} \nabla \cdot k \nabla T + H\]</div>
<p>The term in square brackets is simply the statement of mass
conservation and we know immediately that this is zero.</p>
<p>If the heat capacity, <span class="math notranslate nohighlight">\(C_p\)</span> and thermal conductivity, <span class="math notranslate nohighlight">\(k\)</span> are constants,
then the conservation equation becomes</p>
<div class="math notranslate nohighlight" id="equation-eq-energycons">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-energycons" title="Permalink to this equation">¶</a></span>\[    \Red{ \left( \frac{\partial T}{\partial t} + \mathbf{v} \cdot \nabla T \right)=
                        \kappa \nabla^2 T + \frac{H}{C_p} }\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa\)</span> is the thermal diffusivity, <span class="math notranslate nohighlight">\(\kappa = k/\rho C_p\)</span>.</p>
<p>It probably did not go unnoticed that we assumed <span class="math notranslate nohighlight">\(\rho\)</span> to be constant to get to
this point. It is quite common to assume a material is near-enough incompressible
that density changes can be ignored. In fact, this is a reasonable assumption even
for air if the velocity is well below the speed of sound. It is also possible
to keep assuming incompressibility even when accounting for density variations
whose buoyancy effects drive deformation. There is a lot more detail
on this in Ricard, 2015<a class="footnote-reference brackets" href="#ricard-treatise" id="id1">1</a> and we will come back to it soon.</p>
<!-- This equation is only linear if the velocity field is specified in advance
and is independent of $T$ (which is not a very interesting case). -->
<p>A new bit
of notation has appeared in the process of this derivation. The
the <span class="math notranslate nohighlight">\(\mathbf{v} \cdot \nabla\)</span> operator is a derivative that lies
along the direction of motion <span class="math notranslate nohighlight">\(\mathbf{v}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{v} \cdot \nabla \equiv v_j \frac{\partial}{\partial x_j}\]</div>
<p>For later reference, this is how it looks:
$<span class="math notranslate nohighlight">\((\mathbf{v} \cdot \nabla) T = v_1 \frac{\partial T}{\partial x_1} + 
                v_2 \frac{\partial T}{\partial x_2} + v_3 \frac{\partial T}{\partial x_3}\)</span>$</p>
<p>The Laplacian, <span class="math notranslate nohighlight">\(\nabla^2\)</span>, is this expression (for scalar <span class="math notranslate nohighlight">\(T\)</span>)</p>
<div class="math notranslate nohighlight">
\[\nabla^2 T \equiv \frac{\partial^2 T}{\partial x_1^2} + \frac{\partial^2 T}{\partial x_2^2} + \frac{\partial^2 T}{\partial x_3^2}\]</div>
</div>
<div class="section" id="conservation-of-momentum">
<h2>Conservation of momentum<a class="headerlink" href="#conservation-of-momentum" title="Permalink to this headline">¶</a></h2>
<p>Momentum is a vector quantity, so the form of
<a class="reference internal" href="#equation-eq-cons1">(1)</a> is different. The source term in the momentum equation represents
a body force, and the surface flux term represents a stress.</p>
<div class="math notranslate nohighlight" id="equation-eq-momcons1">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-momcons1" title="Permalink to this equation">¶</a></span>\[    \frac{d}{dt}\int_{\Omega} \rho \mathbf{v} d\Omega = 
            -   \int_{\Omega} \rho g \hat{\mathbf{z}} d\Omega  
            +   \int_{\Gamma} \boldsymbol{\sigma} \cdot \mathbf{d}\boldsymbol{\Gamma}-
                \int_{\Gamma} \rho \mathbf{v} (\mathbf{v} \cdot \mathbf{d}\boldsymbol{\Gamma})    \]</div>
<p>Gravity provides a body force acting in the vertical direction,
<span class="math notranslate nohighlight">\(\hat{\mathbf{z}}\)</span>. We have introduced the stress tensor,
<span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span>; the force / unit area exerted on an arbitrarily
oriented surface with normal <span class="math notranslate nohighlight">\(\hat{\mathbf {n}}\)</span> is</p>
<div class="math notranslate nohighlight">
\[f_i = \sigma_{ij} n_j\]</div>
<p>The application of Gauss’ theorem, and the equality holds for any
choice of the volume gives this result:</p>
<div class="math notranslate nohighlight" id="equation-eq-momcons2">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-momcons2" title="Permalink to this equation">¶</a></span>\[\frac{\partial}{\partial t}(\rho \mathbf{v}) 
            +\rho g \hat{\mathbf{z}} - \nabla \cdot \sigma + \nabla \cdot (\rho \mathbf{v} \mathbf{v}) = 0\]</div>
<p>Vector notation allows us to keep a number of equations written as one
single equation. However, at this point, keeping the equations in vector
notation makes the situation more confusing. What does that last term on the
left hand side of <a class="reference internal" href="#equation-eq-momcons2">(6)</a> mean ? It is clearer if we use the
index notation instead</p>
<p>Equation <a class="reference internal" href="#equation-eq-momcons2">(6)</a> is equivalent to this:</p>
<div class="math notranslate nohighlight" id="equation-eq-momindx">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-momindx" title="Permalink to this equation">¶</a></span>\[\Green{ \frac{\partial \rho v_i}{\partial t}} + \rho g \delta_{i3} - 
            \frac{\partial \sigma_{ij}}{\partial x_j} +
            \textcolor[rgb]{0.0,0.0,0.7}{ \frac{\partial(\rho v_i v_j)}{\partial x_j}} = 0\]</div>
<p>where that peculiar final term on the left hand side is unambiguous. Repeated indeces in
each term are implicitly summed. <span class="math notranslate nohighlight">\(\delta_{ij}\)</span> is the kronecker
delta which obeys:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\delta_{ij} = \begin{cases}
                0 &amp; \text{if $i \neq j$}, \\
                1 &amp; \text{if $i = j$}.
            \end{cases}\end{split}\]</div>
<p>If we expand the derivatives of products of two terms
and recombine them in the right way:</p>
<div class="math notranslate nohighlight">
\[v_i \left[\Green{ \frac{\partial \rho}{\partial t}} +
             \Blue{  \frac{\partial \rho v_j}{\partial x_j}} \right]
            + \Green{ \rho \frac{\partial v_i}{\partial t}} + \Blue{ \rho v_j \frac{\partial v_i}{\partial x_j}} =
            \frac{\partial \sigma_{ij}}{\partial x_j} -\rho g \delta_{i3}\]</div>
<p>The term in square brackets is, in fact, a restatement of the
conservation of mass derived above and must vanish. The remaining terms
can now be written out in vector notation as</p>
<div class="math notranslate nohighlight" id="equation-eq-momcons3">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-momcons3" title="Permalink to this equation">¶</a></span>\[\Red{   \rho \left( \frac{\partial \mathbf{v}}{\partial t}
                            + (\mathbf{v} \cdot \nabla) \mathbf{v} \right) =
                         \nabla \cdot \boldsymbol{\sigma} - g\rho\hat{\mathbf{z}}      }\]</div>
<p>Note: The <span class="math notranslate nohighlight">\(\mathbf{v} \cdot \nabla\)</span> notation we introduced earlier is
now an operator on a vector.  Written out it looks like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
                    (\mathbf{v} \cdot \nabla) \mathbf{u} = 
                        &amp; \hat{\boldsymbol{\imath}} \left( v_1 \frac{\partial u_1}{\partial x_1} + 
                        v_2 \frac{\partial u_1}{\partial x_2} + v_3 \frac{\partial u_1}{\partial x_3} \right) \\
                            &amp; \hat{\boldsymbol{\jmath}} \left( v_1 \frac{\partial u_2}{\partial x_1} + 
                        v_2 \frac{\partial u_2}{\partial x_2} + v_3 \frac{\partial u_2}{\partial x_3} \right) \\
                            &amp; \hat{\boldsymbol{k}} \left( v_1 \frac{\partial u_3}{\partial x_1} + 
                        v_2 \frac{\partial u_3}{\partial x_2} + v_3 \frac{\partial u_3}{\partial x_3} \right) \\                
                \end{split}\end{split}\]</div>
<hr class="docutils" />
<dl class="footnote brackets">
<dt class="label" id="ricard-treatise"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Ricard, Y. “Physics of Mantle Convection.” In Treatise on Geophysics, 23–71. Elsevier, 2015. https://doi.org/10.1016/B978-0-444-53802-4.00127-5.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Part1-FluidDynamics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../Part0-Introduction/Introduction.html" title="previous page">Introduction</a>
    <a class='right-next' id="next-link" href="NavierStokes.html" title="next page">Navier-Stokes Equation</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Louis Moresi<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>